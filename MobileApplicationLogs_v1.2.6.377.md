# Mobile Application Logs for Build v1.2.6+377
[22:18:59] EDIT: Loading tour stops from /data/user/0/com.audiotours.dev/app_flutter/tours/6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:18:59] EDIT: Parsing HTML content (7572 chars)
[22:18:59] EDIT: Detected NEW style tour (audio_X.mp3)
[22:18:59] EDIT: Found stops: [1, 2, 3, 4, 5, 6, 7, 8]
[22:18:59] EDIT: Created 8 stops
[22:18:59] EDIT: Loaded 8 stops
[22:18:59] CALL_STACK: _hasAnyChanges called from:
[22:18:59] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:18:59] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:702)
[22:18:59] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:18:59] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:18:59] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:18:59] SAVE_MESSAGE: the message object contains 0 messages
[22:18:59] CRITICAL_CHANGES: _hasAnyChanges checking 8 stops
[22:18:59] CRITICAL_CHANGES: No changes found, returning false
[22:18:59] CALL_STACK: _hasAnyChanges called from:
[22:18:59] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:18:59] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:833)
[22:18:59] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:18:59] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:18:59] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:18:59] SAVE_MESSAGE: the message object contains 0 messages
[22:18:59] CRITICAL_CHANGES: _hasAnyChanges checking 8 stops
[22:18:59] CRITICAL_CHANGES: No changes found, returning false
[22:18:59] CALL_STACK: _hasAnyChanges called from:
[22:18:59] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:18:59] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:834)
[22:18:59] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:18:59] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:18:59] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:18:59] SAVE_MESSAGE: the message object contains 0 messages
[22:18:59] CRITICAL_CHANGES: _hasAnyChanges checking 8 stops
[22:18:59] CRITICAL_CHANGES: No changes found, returning false
[22:19:13] CRITICAL_ADD: Added new stop 9 with action=add, modified=true
[22:19:13] CALL_STACK: _hasAnyChanges called from:
[22:19:13] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:13] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:702)
[22:19:13] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:13] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:13] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:13] SAVE_MESSAGE: the message object contains 0 messages
[22:19:13] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:13] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:13] CALL_STACK: _hasAnyChanges called from:
[22:19:13] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:13] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:833)
[22:19:13] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:13] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:13] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:13] SAVE_MESSAGE: the message object contains 0 messages
[22:19:13] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:13] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:13] CALL_STACK: _hasAnyChanges called from:
[22:19:13] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:13] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:834)
[22:19:13] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:13] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:13] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:13] SAVE_MESSAGE: the message object contains 0 messages
[22:19:13] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:13] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:15] EDIT_STOP: HTML5 audio services initialized
[22:19:16] HTML_RECORDER: Initialized successfully
[22:19:16] UPLOAD: Starting audio file upload
[22:19:16] UPLOAD: Storage permission not granted, requesting...
[22:19:16] UPLOAD: Storage permission denied by user
[22:19:18] UPLOAD: Opening file picker
[22:19:22] UPLOAD: Selected file: AudiouraElevetorPitch_1.mp3 (575177 bytes)
[22:19:22] UPLOAD: File copied to /data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3 (575177 bytes)
[22:19:22] UPLOAD: File uploaded successfully as part 0
[22:19:22] HTML_AUDIO: Loaded audio player for /data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3
[22:19:22] AUDIO_LOAD: Loaded part 0: /data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3
[22:19:27] AUDIO_PROTOCOL: hasUploaded=true, onlyRecordings=false
[22:19:27] AUDIO_PROTOCOL: Single uploaded file - using directly: /data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3
[22:19:27] MULTI_PART: Custom recording ready with 1 parts using direct file
[22:19:30] EDIT: Marking stop 9 as modified
[22:19:30] EDIT: Custom audio mode - using recorded audio, action preserved: add
[22:19:30] CALL_STACK: _hasAnyChanges called from:
[22:19:30] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:30] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:702)
[22:19:30] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:30] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:30] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:30] SAVE_MESSAGE: the message object contains 0 messages
[22:19:30] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:30] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:30] CALL_STACK: _hasAnyChanges called from:
[22:19:30] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:30] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:833)
[22:19:30] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:30] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:30] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:30] SAVE_MESSAGE: the message object contains 0 messages
[22:19:30] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:30] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:30] CALL_STACK: _hasAnyChanges called from:
[22:19:30] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:30] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:834)
[22:19:30] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:30] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:30] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:30] SAVE_MESSAGE: the message object contains 0 messages
[22:19:30] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:30] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:36] _saveAllChanges BEFORE save: Stop 0 - number=1, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 1 - number=2, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 2 - number=3, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 3 - number=4, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 4 - number=5, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 5 - number=6, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 6 - number=7, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 7 - number=8, modified=false, action=null, moved=null
[22:19:36] _saveAllChanges BEFORE save: Stop 8 - number=9, modified=true, action=add, moved=null
[22:19:36] CRITICAL_SAVE: Remaining stops after delete filter: 9
[22:19:36] CALL_STACK: _hasAnyChanges called from:
[22:19:36] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:36] CALL_STACK: 1: #1      _EditTourScreenState._saveAllChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:273)
[22:19:36] CALL_STACK: 2: <asynchronous suspension>
[22:19:36] CALL_STACK: 3: #2      _EditTourScreenState.build.<anonymous closure> (package:audio_tour_app_dev/screens/edit_tour_screen.dart:833)
[22:19:36] CALL_STACK: 4: <asynchronous suspension>
[22:19:36] SAVE_MESSAGE: the message object contains 2 messages
[22:19:36] SAVE_MESSAGE: _saveAllChanges method started
[22:19:36] SAVE_MESSAGE: Processing 9 stops
[22:19:36] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:36] CALLER_MESSAGE: Called from _saveAllChanges - testing message passing
[22:19:36] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:36] _saveAllChanges: _hasAnyChanges() returned: true
[22:19:36] EDIT: Using backend tour ID: 6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:19:36] CRITICAL_TOUR_ID: tourPath=/data/user/0/com.audiotours.dev/app_flutter/tours/6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:19:36] CRITICAL_TOUR_ID: extracted tourId=6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:19:36] CRITICAL_TOUR_ID: sending to backend=6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:19:36] CRITICAL_SAVE: Modified stops filter found: 1 stops
[22:19:36] CRITICAL_SAVE: Modified stop 0 - number=9, modified=true, action=add
[22:19:36] EDIT: Sending only 1 modified stops - backend preserves others
[22:19:36] EDIT: Preparing 1 stops for backend
[22:19:36] CRITICAL_JSON: {"stops":[{"stop_number":9,"title":"Stop 9","text":"Testing 48","original_text":"","audio_file":"audio_9.mp3","editable":true,"modified":true,"action":"add","has_custom_audio":true,"audio_source":"user_recorded","generate_audio_from_text":false,"custom_audio_path":"/data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3","custom_audio_archived":true,"recording_parts":["/data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3"]}]}
[22:19:36] SERVICE_DIRECT: updateMultipleStops method called with tourId: 6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:19:36] SERVICE_DIRECT: ===== TourEditingService.updateMultipleStops CALLED =====
[22:19:36] EDIT API: Tour ID: 6dd7e8bf-c934-4b6b-922f-3ba32df84108
[22:19:36] EDIT API: Received 1 stops to process
[22:19:36] EDIT API: Stop 0 - Number: 9, Action: add, Modified: true
[22:19:36] EDIT API: Stop 0 - Has custom audio: true, Audio path: /data/data/com.audiotours.dev/cache/uploaded_audio_1761099562152.mp3
[22:19:36] EDIT API: Stop 9 - First 20 bytes: [73, 68, 51, 4, 0, 0, 0, 0, 0, 127, 84, 88, 88, 88, 0, 0, 0, 18, 0, 0]
[22:19:36] EDIT API: Stop 9 - Headers: "ID3" + "TX"
[22:19:36] EDIT API: Stop 9 - WARNING: Not WAV format! Headers: ID3/TX
[22:19:36] EDIT API: Stop 9 - Using custom audio (575177 bytes)
[22:19:36] EDIT API: ===== MAKING HTTP POST REQUEST =====
[22:19:36] EDIT API: URL: http://192.168.0.217:5022/tour/6dd7e8bf-c934-4b6b-922f-3ba32df84108/update-multiple-stops
[22:19:36] EDIT API: Payload stops count: 1
[22:19:37] EDIT API: ===== HTTP RESPONSE RECEIVED =====
[22:19:37] EDIT API: Response status: 200
[22:19:37] EDIT API: Response body: {"download_url":"/tour/836c731a-60ef-49f2-aab1-cb18398e451e/download","message":"Tour updated successfully with 1 custom audio recording(s) and 0 text-to-speech audio(s)","new_tour_id":"836c731a-60ef-49f2-aab1-cb18398e451e","status":"success","stops":[{"audio_source":"user_recorded","audio_updated":true,"generate_audio_from_text":false,"has_custom_audio":true,"stop_number":9,"text_updated":true}]}

[22:19:37] EDIT API: Save success - Tour updated successfully with 1 custom audio recording(s) and 0 text-to-speech audio(s)
[22:19:37] API_CALL: TourEditingService.updateMultipleStops returned successfully
[22:19:37] API_CALL: Response keys: [download_url, message, new_tour_id, status, stops]
[22:19:37] EDIT: Save response: {download_url: /tour/836c731a-60ef-49f2-aab1-cb18398e451e/download, message: Tour updated successfully with 1 custom audio recording(s) and 0 text-to-speech audio(s), new_tour_id: 836c731a-60ef-49f2-aab1-cb18398e451e, status: success, stops: [{audio_source: user_recorded, audio_updated: true, generate_audio_from_text: false, has_custom_audio: true, stop_number: 9, text_updated: true}]}
[22:19:37] CRITICAL_TOUR_ID: Backend returned new_tour_id=836c731a-60ef-49f2-aab1-cb18398e451e
[22:19:37] TOUR_ID_FIX: Updated tour path from /data/user/0/com.audiotours.dev/app_flutter/tours/6dd7e8bf-c934-4b6b-922f-3ba32df84108 to /data/user/0/com.audiotours.dev/app_flutter/tours/836c731a-60ef-49f2-aab1-cb18398e451e
[22:19:37] EDIT: Starting new tour download process
[22:19:37] EDIT: REQ-016 new tour created: 836c731a-60ef-49f2-aab1-cb18398e451e
[22:19:37] EDIT: Download paths - old: /data/user/0/com.audiotours.dev/app_flutter/tours/836c731a-60ef-49f2-aab1-cb18398e451e, new: /data/user/0/com.audiotours.dev/app_flutter/tours/836c731a-60ef-49f2-aab1-cb18398e451e
[22:19:37] EDIT API: Downloading updated tour 836c731a-60ef-49f2-aab1-cb18398e451e
[22:19:38] EDIT API: Downloaded 5734524 bytes
[22:19:38] EDIT API: Error extracting files: PathNotFoundException: Cannot open file, path = '/data/user/0/com.audiotours.dev/app_flutter/tours/836c731a-60ef-49f2-aab1-cb18398e451e/audio_1.mp3' (OS Error: No such file or directory, errno = 2)
[22:19:38] EDIT API: Download error: PathNotFoundException: Cannot open file, path = '/data/user/0/com.audiotours.dev/app_flutter/tours/836c731a-60ef-49f2-aab1-cb18398e451e/audio_1.mp3' (OS Error: No such file or directory, errno = 2)
[22:19:38] EDIT: Error in new tour download: Exception: Failed to download updated tour.
[22:19:38] CALL_STACK: _hasAnyChanges called from:
[22:19:38] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:38] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:702)
[22:19:38] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:38] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:38] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:38] SAVE_MESSAGE: the message object contains 0 messages
[22:19:38] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:38] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:38] CALL_STACK: _hasAnyChanges called from:
[22:19:38] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:38] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:833)
[22:19:38] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:38] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:38] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:38] SAVE_MESSAGE: the message object contains 0 messages
[22:19:38] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:38] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:19:38] CALL_STACK: _hasAnyChanges called from:
[22:19:38] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[22:19:38] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:834)
[22:19:38] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[22:19:38] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[22:19:38] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[22:19:38] SAVE_MESSAGE: the message object contains 0 messages
[22:19:38] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[22:19:38] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[22:20:02] Checking user: USER-281301397
[22:20:02] Testing connectivity to: 192.168.0.217
[22:20:02] âœ… Server connectivity: OK