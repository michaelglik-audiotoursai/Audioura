# logs for build v1.2.6+376
[19:58:33] EDIT: Loading tour stops from /data/user/0/com.audiotours.dev/app_flutter/tours/6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:58:33] EDIT: Parsing HTML content (7572 chars)
[19:58:33] EDIT: Detected NEW style tour (audio_X.mp3)
[19:58:33] EDIT: Found stops: [1, 2, 3, 4, 5, 6, 7, 8]
[19:58:33] EDIT: Created 8 stops
[19:58:33] EDIT: Loaded 8 stops
[19:58:33] CALL_STACK: _hasAnyChanges called from:
[19:58:33] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:58:33] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:681)
[19:58:33] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:58:33] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:58:33] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:58:33] SAVE_MESSAGE: the message object contains 0 messages
[19:58:33] CRITICAL_CHANGES: _hasAnyChanges checking 8 stops
[19:58:33] CRITICAL_CHANGES: No changes found, returning false
[19:58:33] CALL_STACK: _hasAnyChanges called from:
[19:58:33] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:58:33] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:812)
[19:58:33] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:58:33] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:58:33] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:58:33] SAVE_MESSAGE: the message object contains 0 messages
[19:58:33] CRITICAL_CHANGES: _hasAnyChanges checking 8 stops
[19:58:33] CRITICAL_CHANGES: No changes found, returning false
[19:58:33] CALL_STACK: _hasAnyChanges called from:
[19:58:33] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:58:33] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:813)
[19:58:33] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:58:33] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:58:33] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:58:33] SAVE_MESSAGE: the message object contains 0 messages
[19:58:33] CRITICAL_CHANGES: _hasAnyChanges checking 8 stops
[19:58:33] CRITICAL_CHANGES: No changes found, returning false
[19:58:49] CRITICAL_ADD: Added new stop 9 with action=add, modified=true
[19:58:49] CALL_STACK: _hasAnyChanges called from:
[19:58:49] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:58:49] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:681)
[19:58:49] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:58:49] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:58:49] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:58:49] SAVE_MESSAGE: the message object contains 0 messages
[19:58:49] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:58:49] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:58:49] CALL_STACK: _hasAnyChanges called from:
[19:58:49] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:58:49] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:812)
[19:58:49] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:58:49] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:58:49] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:58:49] SAVE_MESSAGE: the message object contains 0 messages
[19:58:49] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:58:49] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:58:49] CALL_STACK: _hasAnyChanges called from:
[19:58:49] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:58:49] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:813)
[19:58:49] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:58:49] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:58:49] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:58:49] SAVE_MESSAGE: the message object contains 0 messages
[19:58:49] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:58:49] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:58:54] EDIT_STOP: HTML5 audio services initialized
[19:58:54] HTML_RECORDER: Initialized successfully
[19:59:00] UPLOAD: Starting audio file upload
[19:59:00] UPLOAD: Storage permission not granted, requesting...
[19:59:00] UPLOAD: Storage permission denied by user
[19:59:01] UPLOAD: Opening file picker
[19:59:06] UPLOAD: Selected file: AudiouraElevetorPitch_1.mp3 (575177 bytes)
[19:59:06] UPLOAD: File copied to /data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3 (575177 bytes)
[19:59:06] UPLOAD: File uploaded successfully as part 0
[19:59:06] HTML_AUDIO: Loaded audio player for /data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3
[19:59:06] AUDIO_LOAD: Loaded part 0: /data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3
[19:59:18] AUDIO_PROTOCOL: hasUploaded=true, onlyRecordings=false
[19:59:18] AUDIO_PROTOCOL: Single uploaded file - using directly: /data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3
[19:59:18] MULTI_PART: Custom recording ready with 1 parts using direct file
[19:59:25] EDIT: Marking stop 9 as modified
[19:59:25] EDIT: Custom audio mode - using recorded audio, action preserved: add
[19:59:25] CALL_STACK: _hasAnyChanges called from:
[19:59:25] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:25] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:681)
[19:59:25] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:59:25] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:59:25] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:59:25] SAVE_MESSAGE: the message object contains 0 messages
[19:59:25] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:25] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:59:25] CALL_STACK: _hasAnyChanges called from:
[19:59:25] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:25] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:812)
[19:59:25] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:59:25] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:59:25] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:59:25] SAVE_MESSAGE: the message object contains 0 messages
[19:59:25] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:25] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:59:25] CALL_STACK: _hasAnyChanges called from:
[19:59:25] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:25] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:813)
[19:59:25] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:59:25] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:59:25] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:59:25] SAVE_MESSAGE: the message object contains 0 messages
[19:59:25] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:25] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:59:31] _saveAllChanges BEFORE save: Stop 0 - number=1, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 1 - number=2, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 2 - number=3, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 3 - number=4, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 4 - number=5, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 5 - number=6, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 6 - number=7, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 7 - number=8, modified=false, action=null, moved=null
[19:59:31] _saveAllChanges BEFORE save: Stop 8 - number=9, modified=true, action=add, moved=null
[19:59:31] CRITICAL_SAVE: Remaining stops after delete filter: 9
[19:59:31] CALL_STACK: _hasAnyChanges called from:
[19:59:31] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:31] CALL_STACK: 1: #1      _EditTourScreenState._saveAllChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:273)
[19:59:31] CALL_STACK: 2: <asynchronous suspension>
[19:59:31] CALL_STACK: 3: #2      _EditTourScreenState.build.<anonymous closure> (package:audio_tour_app_dev/screens/edit_tour_screen.dart:812)
[19:59:31] CALL_STACK: 4: <asynchronous suspension>
[19:59:31] SAVE_MESSAGE: the message object contains 2 messages
[19:59:31] SAVE_MESSAGE: _saveAllChanges method started
[19:59:31] SAVE_MESSAGE: Processing 9 stops
[19:59:31] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:31] CALLER_MESSAGE: Called from _saveAllChanges - testing message passing
[19:59:31] CRITICAL_CHANGES: Stop 8 (9) - modified=true, action=add, moved=null, hasChange=true
[19:59:31] _saveAllChanges: _hasAnyChanges() returned: true
[19:59:31] EDIT: Using backend tour ID: 6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:59:31] CRITICAL_TOUR_ID: tourPath=/data/user/0/com.audiotours.dev/app_flutter/tours/6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:59:31] CRITICAL_TOUR_ID: extracted tourId=6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:59:31] CRITICAL_TOUR_ID: sending to backend=6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:59:31] CRITICAL_SAVE: Modified stops filter found: 1 stops
[19:59:31] CRITICAL_SAVE: Modified stop 0 - number=9, modified=true, action=add
[19:59:31] EDIT: Sending only 1 modified stops - backend preserves others
[19:59:31] EDIT: Preparing 1 stops for backend
[19:59:31] CRITICAL_JSON: {"stops":[{"stop_number":9,"title":"Stop 9","text":"Testing 47","original_text":"","audio_file":"audio_9.mp3","editable":true,"modified":true,"action":"add","has_custom_audio":true,"audio_source":"user_recorded","generate_audio_from_text":false,"custom_audio_path":"/data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3","custom_audio_archived":true,"recording_parts":["/data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3"]}]}
[19:59:31] SERVICE_DIRECT: updateMultipleStops method called with tourId: 6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:59:31] SERVICE_DIRECT: ===== TourEditingService.updateMultipleStops CALLED =====
[19:59:31] EDIT API: Tour ID: 6dd7e8bf-c934-4b6b-922f-3ba32df84108
[19:59:31] EDIT API: Received 1 stops to process
[19:59:31] EDIT API: Stop 0 - Number: 9, Action: add, Modified: true
[19:59:31] EDIT API: Stop 0 - Has custom audio: true, Audio path: /data/data/com.audiotours.dev/cache/uploaded_audio_1761091146464.mp3
[19:59:31] EDIT API: Stop 9 - First 20 bytes: [73, 68, 51, 4, 0, 0, 0, 0, 0, 127, 84, 88, 88, 88, 0, 0, 0, 18, 0, 0]
[19:59:31] EDIT API: Stop 9 - Headers: "ID3" + "TX"
[19:59:31] EDIT API: Stop 9 - WARNING: Not WAV format! Headers: ID3/TX
[19:59:31] EDIT API: Stop 9 - Using custom audio (575177 bytes)
[19:59:31] EDIT API: ===== MAKING HTTP POST REQUEST =====
[19:59:31] EDIT API: URL: http://192.168.0.217:5022/tour/6dd7e8bf-c934-4b6b-922f-3ba32df84108/update-multiple-stops
[19:59:31] EDIT API: Payload stops count: 1
[19:59:32] EDIT API: ===== HTTP RESPONSE RECEIVED =====
[19:59:32] EDIT API: Response status: 200
[19:59:32] EDIT API: Response body: {"download_url":"/tour/6a7381c4-7e50-415d-a814-37411f5a997d/download","message":"Tour updated successfully with 1 custom audio recording(s) and 0 text-to-speech audio(s)","new_tour_id":"6a7381c4-7e50-415d-a814-37411f5a997d","status":"success","stops":[{"audio_source":"user_recorded","audio_updated":true,"generate_audio_from_text":false,"has_custom_audio":true,"stop_number":9,"text_updated":true}]}

[19:59:32] EDIT API: Save success - Tour updated successfully with 1 custom audio recording(s) and 0 text-to-speech audio(s)
[19:59:32] API_CALL: TourEditingService.updateMultipleStops returned successfully
[19:59:32] API_CALL: Response keys: [download_url, message, new_tour_id, status, stops]
[19:59:32] EDIT: Save response: {download_url: /tour/6a7381c4-7e50-415d-a814-37411f5a997d/download, message: Tour updated successfully with 1 custom audio recording(s) and 0 text-to-speech audio(s), new_tour_id: 6a7381c4-7e50-415d-a814-37411f5a997d, status: success, stops: [{audio_source: user_recorded, audio_updated: true, generate_audio_from_text: false, has_custom_audio: true, stop_number: 9, text_updated: true}]}
[19:59:32] CRITICAL_TOUR_ID: Backend returned new_tour_id=6a7381c4-7e50-415d-a814-37411f5a997d
[19:59:32] EDIT: Starting new tour download process
[19:59:32] EDIT: REQ-016 new tour created: 6a7381c4-7e50-415d-a814-37411f5a997d
[19:59:32] EDIT API: Downloading updated tour 6a7381c4-7e50-415d-a814-37411f5a997d
[19:59:33] EDIT API: Downloaded 5734523 bytes
[19:59:33] EDIT API: Extracted 19 files
[19:59:33] EDIT API: Tour download and extraction completed
[19:59:33] DEBUG_UPDATE_ID: Starting _updateLocalTourId with newTourId: 6a7381c4-7e50-415d-a814-37411f5a997d
[19:59:33] DEBUG_UPDATE_ID: Local tour updated with new ID reference
[19:59:33] EDIT: Loading tour stops from /data/user/0/com.audiotours.dev/app_flutter/tours/6a7381c4-7e50-415d-a814-37411f5a997d
[19:59:33] EDIT: Error loading stops: Exception: Tour index.html not found
[19:59:33] DEBUG_RESET: Processing 9 stops
[19:59:33] CALL_STACK: _hasAnyChanges called from:
[19:59:33] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:33] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:681)
[19:59:33] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:59:33] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:59:33] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:59:33] SAVE_MESSAGE: the message object contains 0 messages
[19:59:33] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:33] CRITICAL_CHANGES: Stop 8 (9) - modified=false, action=add, moved=null, hasChange=true
[19:59:33] CALL_STACK: _hasAnyChanges called from:
[19:59:33] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:33] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:812)
[19:59:33] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:59:33] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:59:33] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:59:33] SAVE_MESSAGE: the message object contains 0 messages
[19:59:33] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:33] CRITICAL_CHANGES: Stop 8 (9) - modified=false, action=add, moved=null, hasChange=true
[19:59:33] CALL_STACK: _hasAnyChanges called from:
[19:59:33] CALL_STACK: 0: #0      _EditTourScreenState._hasAnyChanges (package:audio_tour_app_dev/screens/edit_tour_screen.dart:194)
[19:59:33] CALL_STACK: 1: #1      _EditTourScreenState.build (package:audio_tour_app_dev/screens/edit_tour_screen.dart:813)
[19:59:33] CALL_STACK: 2: #2      StatefulElement.build (package:flutter/src/widgets/framework.dart:5743)
[19:59:33] CALL_STACK: 3: #3      ComponentElement.performRebuild (package:flutter/src/widgets/framework.dart:5631)
[19:59:33] CALL_STACK: 4: #4      StatefulElement.performRebuild (package:flutter/src/widgets/framework.dart:5794)
[19:59:33] SAVE_MESSAGE: the message object contains 0 messages
[19:59:33] CRITICAL_CHANGES: _hasAnyChanges checking 9 stops
[19:59:33] CRITICAL_CHANGES: Stop 8 (9) - modified=false, action=add, moved=null, hasChange=true
[19:59:48] Checking user: USER-281301397
[19:59:48] Testing connectivity to: 192.168.0.217
[19:59:48] ✅ Server connectivity: OK